<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js">
<!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <title>Fix just about any Windows Update issue – Martino Jones</title> <meta name="description" content="This is my personal blog where I talk about projects I'm working on and other technology related things."> <meta name="keywords" content=""> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="https://martinojones.com/assets/img/logo.jpg"> <meta name="twitter:title" content="Fix just about any Windows Update issue"> <meta name="twitter:description" content="I’ve seen a lot of Windows Updates issues, and no I’m not talking about updates breaking your system, I’m talking about Windows Updates not working at all. I’m sure you’ve probably seen it at least once before. I know I have, when ever I fix someones computer I always check Windows Updates to make sure it’s working properly and I typically run into an error that the user has been ignoring.Well I made a script for that, this one I made in Batch because you never know what version of Windows or PowerShell they are running, and it’s faster than doing a “powershell set-executionpolicy unrestricted” and then running my script. PowerShell is also a bit slower with runtime, Batch is old and fast :-). I made this thing years ago, back when I graduated high school whenWindows XP was out, it’s worked on Windows all the way up to a recentWindows 10 (10041) issue I had. Any who here’s my script, I commented as much of it as I could, it says it’s for a certain error but really it works for almost every Windows Updates error I’ve had.All you have to do is copy this, open Notepad (or what ever text editor like Sublime), then save it as a .bat file, then just double-click the file"> <meta name="twitter:site" content="@martinoj2009"> <meta name="twitter:creator" content="@martinoj2009"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Fix just about any Windows Update issue"> <meta property="og:description" content="I’ve seen a lot of Windows Updates issues, and no I’m not talking about updates breaking your system, I’m talking about Windows Updates not working at all. I’m sure you’ve probably seen it at least once before. I know I have, when ever I fix someones computer I always check Windows Updates to make sure it’s working properly and I typically run into an error that the user has been ignoring.Well I made a script for that, this one I made in Batch because you never know what version of Windows or PowerShell they are running, and it’s faster than doing a “powershell set-executionpolicy unrestricted” and then running my script. PowerShell is also a bit slower with runtime, Batch is old and fast :-). I made this thing years ago, back when I graduated high school whenWindows XP was out, it’s worked on Windows all the way up to a recentWindows 10 (10041) issue I had. Any who here’s my script, I commented as much of it as I could, it says it’s for a certain error but really it works for almost every Windows Updates error I’ve had.All you have to do is copy this, open Notepad (or what ever text editor like Sublime), then save it as a .bat file, then just double-click the file"> <meta property="og:url" content="https://martinojones.com/fix-just-about-any-windows-update-issue/"> <meta property="og:site_name" content="Martino Jones"> <meta property="og:image" content="https://martinojones.com/assets/img/logo.jpg"> <link rel="canonical" href="https://martinojones.com/fix-just-about-any-windows-update-issue/"> <link href="https://martinojones.com/feed.xml" type="application/atom+xml" rel="alternate" title="Martino Jones Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="https://martinojones.com/assets/css/main.css"> <!-- JS --> <script src="https://martinojones.com/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="https://martinojones.com/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="https://martinojones.com/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="https://martinojones.com/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="https://martinojones.com/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="https://martinojones.com/favicon.png"> <link rel="shortcut icon" href="https://martinojones.com/favicon.ico"> <!-- Background Image --> <style type="text/css">body {background-image:url(https://martinojones.com/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="https://martinojones.com/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="https://martinojones.com/assets/img/logo.jpg" alt="Martino Jones photo" class="author-photo"> <h4>Martino Jones</h4> <p>This is my personal blog where I talk about projects I'm working on and other technology related things.</p> </li> <li><a href="https://martinojones.com/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="http://twitter.com/martinoj2009" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a> </li> <li> <a href="http://plus.google.com/+martinoj2009" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-google-plus-square"></i> Google+</a> </li> <li> <a href="http://linkedin.com/in/martinojones" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> </li> <li> <a href="http://github.com/martinoj2009" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> <li> <a href="http://steamcommunity.com/id/martinoj2009" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-steam-square"></i> Steam</a> </li> <li> <a href="https://youtube.com/user/martinoj2009" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-youtube-square"></i> Youtube</a> </li> </ul>
<!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="https://martinojones.com/posts/">All Posts</a></li> <li><a href="https://martinojones.com/tags/">All Tags</a></li> </ul> </li> <li><a href="https://martinojones.com/projects/">Projects</a></li> </ul>
<!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>Fix just about any Windows Update issue</h1> <h4>22 Mar 2015</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~2 minutes </p>
<!-- /.entry-reading-time --> <a class="btn zoombtn" href="https://martinojones.com/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <!-- martinojones.com --> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3961058330418465" data-ad-slot="8621008831" data-ad-format="auto"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script> I've seen a lot of Windows Updates issues, and no I'm not talking about updates breaking your system, I'm talking about Windows Updates not working at all. I'm sure you've probably seen it at least once before. I know I have, when ever I fix someones computer I always check Windows Updates to make sure it's working properly and I typically run into an error that the user has been ignoring.<br> <br> Well I made a script for that, this one I made in Batch because you never know what version of Windows or PowerShell they are running, and it's faster than doing a "<b>powershell set-executionpolicy unrestricted</b>" and then running my script. PowerShell is also a bit slower with runtime, Batch is old and fast :-). <br> <br> I made this thing years ago, back when I graduated high school when Windows XP was out, it's worked on Windows all the way up to a recent Windows 10 (10041) issue I had. Any who here's my script, I commented as much of it as I could, it says it's for a certain error but really it works for almost every Windows Updates error I've had.<br> <br> <i><b>*All you have to do is copy this, open Notepad (or what ever text editor like Sublime), then save it as a .bat file, then just double-click the file*</b></i><br> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">REM</span> <span class="no">START</span>
<span class="no">REM</span> <span class="no">Martino</span> <span class="no">Jones</span>
<span class="vi">@echo</span> <span class="n">off</span>
<span class="no">REM</span> <span class="sr">//</span> <span class="no">This</span> <span class="n">script</span> <span class="n">will</span> <span class="n">fix</span> <span class="n">the</span> <span class="mi">80246003</span> <span class="n">error</span> <span class="n">after</span> <span class="n">you</span> <span class="n">have</span> <span class="n">updated</span> <span class="n">from</span> <span class="no">Windows</span> <span class="mi">7</span> <span class="n">to</span> <span class="no">Windows</span> <span class="mi">8</span>
<span class="no">REM</span> <span class="sr">//</span> <span class="o">***</span><span class="no">This</span> <span class="no">MUST</span> <span class="n">be</span> <span class="n">run</span> <span class="n">as</span> <span class="no">Administrator</span><span class="o">***</span>

<span class="no">REM</span> <span class="sr">//</span> <span class="no">This</span> <span class="n">will</span> <span class="n">first</span> <span class="n">stop</span> <span class="n">the</span> <span class="no">Windows</span> <span class="no">Update</span> <span class="no">Service</span> <span class="n">from</span> <span class="n">running</span> <span class="n">so</span> <span class="n">the</span> <span class="no">SoftwareDistribution</span> <span class="no">REM</span> <span class="n">folder</span> <span class="n">can</span> <span class="n">be</span> <span class="n">modified</span>
<span class="n">net</span> <span class="n">stop</span> <span class="n">wuauserv</span>
<span class="n">net</span> <span class="n">stop</span> <span class="n">bits</span>


<span class="no">REM</span> <span class="sr">//</span> <span class="no">Now</span> <span class="n">change</span> <span class="n">to</span> <span class="n">the</span> <span class="n">systemroot</span>
<span class="n">cd</span> <span class="o">%</span><span class="n">systemroot</span><span class="o">%</span>

<span class="no">REM</span> <span class="sr">//</span> <span class="no">This</span> <span class="n">will</span> <span class="n">give</span> <span class="n">the</span> <span class="n">service</span> <span class="n">enough</span> <span class="n">time</span> <span class="n">to</span> <span class="n">let</span> <span class="n">go</span> <span class="n">of</span> <span class="n">the</span> <span class="n">folder</span> <span class="k">if</span> <span class="n">needed</span>
<span class="n">ping</span> <span class="mi">127</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">1</span> <span class="o">-</span><span class="n">n</span> <span class="mi">5</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="no">NULL</span>

<span class="no">REM</span> <span class="sr">//</span> <span class="no">This</span> <span class="n">line</span> <span class="n">will</span> <span class="n">rename</span> <span class="n">the</span> <span class="n">old</span> <span class="no">SoftwareDistribution</span> <span class="n">to</span> <span class="no">SoftwareDistribution</span><span class="p">.</span><span class="nf">old</span>
<span class="no">REM</span> <span class="sr">//</span> <span class="no">If</span> <span class="n">you</span> <span class="n">get</span> <span class="n">an</span> <span class="n">access</span> <span class="n">denied</span> <span class="k">then</span> <span class="n">there</span> <span class="n">is</span> <span class="n">a</span> <span class="n">program</span> <span class="n">still</span> <span class="n">holding</span> <span class="n">on</span> <span class="n">to</span> <span class="n">the</span> <span class="n">folder</span><span class="p">,</span> <span class="n">you</span> <span class="n">may</span> <span class="n">need</span> <span class="n">to</span> <span class="n">reboot</span>
<span class="n">ren</span> <span class="no">SoftwareDistribution</span> <span class="no">SoftwareDistribution</span><span class="p">.</span><span class="nf">old</span>

<span class="no">REM</span> <span class="sr">//</span> <span class="no">This</span> <span class="n">will</span> <span class="n">re</span><span class="o">-</span><span class="n">register</span> <span class="n">files</span> <span class="n">needed</span> <span class="k">for</span> <span class="no">Windows</span> <span class="no">Update</span>
<span class="n">regsvr32</span> <span class="sr">/s wuapi.dll
regsvr32 /s</span> <span class="n">wuaueng</span><span class="p">.</span><span class="nf">dll</span>
<span class="n">regsvr32</span> <span class="sr">/s wuaueng1.dll
regsvr32 /s</span> <span class="n">atl</span><span class="p">.</span><span class="nf">dll</span>
<span class="n">regsvr32</span> <span class="sr">/s wucltui.dll
regsvr32 /s</span> <span class="n">wups</span><span class="p">.</span><span class="nf">dll</span>
<span class="n">regsvr32</span> <span class="sr">/s wups2.dll
regsvr32 /s</span> <span class="n">wuweb</span><span class="p">.</span><span class="nf">dll</span>


<span class="no">REM</span> <span class="sr">//</span> <span class="no">This</span> <span class="n">will</span> <span class="n">now</span> <span class="n">start</span> <span class="n">the</span> <span class="no">Windows</span> <span class="no">Update</span> <span class="no">Service</span>
<span class="n">net</span> <span class="n">start</span> <span class="n">wuauserv</span>
<span class="n">net</span> <span class="n">start</span> <span class="n">bits</span>

<span class="no">REM</span> <span class="sr">//</span> <span class="no">This</span> <span class="n">will</span> <span class="n">now</span> <span class="n">delete</span> <span class="n">the</span> <span class="n">old</span> <span class="n">folder</span> <span class="p">(</span><span class="n">optional</span><span class="p">)</span>
<span class="n">rmdir</span> <span class="sr">/Q /</span><span class="no">S</span> <span class="no">SoftwareDistribution</span><span class="p">.</span><span class="nf">old</span>

<span class="no">REM</span> <span class="sr">//</span><span class="no">This</span> <span class="n">will</span> <span class="n">force</span> <span class="n">a</span> <span class="no">Windows</span> <span class="no">Update</span> <span class="p">(</span><span class="n">optional</span><span class="p">),</span> <span class="n">the</span> <span class="n">last</span> <span class="n">one</span> <span class="n">brings</span> <span class="n">up</span> <span class="n">the</span> <span class="no">Windows</span> <span class="no">Update</span> <span class="no">Window</span> <span class="k">in</span> <span class="n">the</span> <span class="no">Control</span> <span class="no">Panel</span><span class="p">.</span>
<span class="nf">wuauclt</span> <span class="sr">/ReportNow /</span><span class="no">DetectNow</span>
<span class="n">wuauctl</span> <span class="sr">/UpdateNow
wuauclt /</span><span class="no">ShowWU</span>
<span class="no">REM</span> <span class="k">END</span></code></pre></figure> <br> <br> Share with who ever you want, it's free to share or reuse how ever you want. <div class="entry-meta"> <br> <hr> <span class="entry-tags"></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=https://martinojones.com/fix-just-about-any-windows-update-issue/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Like</span> </a> <a href="https://twitter.com/intent/tweet?text=https://martinojones.com/fix-just-about-any-windows-update-issue/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=https://martinojones.com/fix-just-about-any-windows-update-issue/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> </header> <!-- JS --> <script src="https://martinojones.com/assets/js/jquery-1.12.0.min.js"></script> <script src="https://martinojones.com/assets/js/jquery.dlmenu.min.js"></script> <script src="https://martinojones.com/assets/js/jquery.goup.min.js"></script> <script src="https://martinojones.com/assets/js/jquery.magnific-popup.min.js"></script> <script src="https://martinojones.com/assets/js/jquery.fitvid.min.js"></script> <script src="https://martinojones.com/assets/js/scripts.js"></script> <!-- Asynchronous Google Analytics snippet --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-79568415-1', 'auto'); ga('require', 'linkid', 'linkid.js'); ga('send', 'pageview'); </script> <script type="text/javascript"> var disqus_shortname = 'martinoj2009'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
