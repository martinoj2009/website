<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js">
<!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <title>PowerShell - get the current directory your script is in – Martino Jones</title> <meta name="description" content="This is my personal blog where I talk about projects I'm working on and other technology related things."> <meta name="keywords" content=""> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="https://martinojones.com/assets/img/logo.jpg"> <meta name="twitter:title" content="PowerShell - get the current directory your script is in"> <meta name="twitter:description" content="Have you ever needed to make a PowerShell script and needed to get the current location of your running script? Of course you have! It doesn’t happen often, but I’ve written scripts and needed to change certain files I expect to be in the current directory, of course I test to make sure the files are there before doing so… but none of that works unless you know where your script is, and I HATE hard coding locations into a script, I try to always use environment variables, because as a “scripter”/programmer you cannot assume things… duh!Anyway, I will use this old Steammachine script I wrote a while back as an example, let’s start with the first line… well first couple:#This is the main script that starts for the Windows SteamBox#Version 0.1.3#Check to make sure Steam is installed#Get location[string]$currentPath=Split-Path ((Get-Variable MyInvocation -Scope 0).Value).MyCommand.PathYeah I cast the variable, I typically only do that when I change a variable a lot so that I don’t do something stupid and assign a number in a variable I expect to be a: string, credential, hex, etc. So as you can see you can take the Split-Path command and use the Get-Variable and retrieve MyInvvocation -Scope 0 and getting the member mycommand and getting the path member on that. Yeah it’s a little convoluted, but it works, and it’s a one liner :-).Here’s the rest of the script, this was something I was using when I first setup my Steammachine on Windows, back when there wasn’t enough games on SteamOS to switch over, I don’t use it anymore– as it now runs SteamOS– and really haven’t changed it since I first wrote it… so use at your own risk :-).#This is the main script that starts for the Windows SteamBox#Version 0.1.3#Check to make sure Steam is installed#Get location[string]$currentPath=Split-Path ((Get-Variable MyInvocation -Scope 0).Value).MyCommand.Path#******BEING FUNCTIONS******##Run Windows Updates functionFunction Get-WindowsUpdate {    [Cmdletbinding()]    Param()    Process {        try {            Write-Verbose “Getting Windows Update”            $Session = New-Object -ComObject Microsoft.Update.Session                        $Searcher = $Session.CreateUpdateSearcher()                        $Criteria = “IsInstalled=0 and DeploymentAction=’Installation’ or IsPresent=1 and DeploymentAction=’Uninstallation’ or IsInstalled=1 and DeploymentAction=’Installation’ and RebootRequired=1 or IsInstalled=0 and DeploymentAction=’Uninstallation’ and RebootRequired=1”                       $SearchResult = $Searcher.Search($Criteria)                       $SearchResult.Updates | Out-File $currentPath\CurrentWindowsUpdates.txt        } catch {            Write-Warning -Message “Failed to query Windows Update because $($_.Exception.Message)” | Out-File $currentPath\ERROR.txt        }    }}#Start script$i = 0do{    [boolean]$SteamFileExists = test-path ${env:ProgramFiles(x86)}\Steam\Steam.exe    if ($SteamFileExists -eq $True){            $i = 1        }        Else        {            $SteamErrorPopup = new-object -comobject wscript.shell            $SteamErrorAnswer = $SteamErrorPopup.popup(“ERROR! STEAM NOT FOUND! “,0,”STEAM NOT FOUND!”,5)            #Check answer            switch ($SteamErrorAnswer)            {                1 {}                2 {Exit}                }            }} Until ($i -eq 1)#Steam Exitsts! Lets start steamStart-Process powershell -Argument “$currentpath\Managesteam.ps1”#Now that we have steam running, lets get to work on the background stuff#Initiate Variables#Wirte to file that steam ran and script worked$Date =  Get-Date$WriteToFile = “Ran correctly at: “ + $Date$WriteToFile | Out-File $currentPath\ran.txt#Run Windows UpdatesGet-WindowsUpdate"> <meta name="twitter:site" content="@martinoj2009"> <meta name="twitter:creator" content="@martinoj2009"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="PowerShell - get the current directory your script is in"> <meta property="og:description" content="Have you ever needed to make a PowerShell script and needed to get the current location of your running script? Of course you have! It doesn’t happen often, but I’ve written scripts and needed to change certain files I expect to be in the current directory, of course I test to make sure the files are there before doing so… but none of that works unless you know where your script is, and I HATE hard coding locations into a script, I try to always use environment variables, because as a “scripter”/programmer you cannot assume things… duh!Anyway, I will use this old Steammachine script I wrote a while back as an example, let’s start with the first line… well first couple:#This is the main script that starts for the Windows SteamBox#Version 0.1.3#Check to make sure Steam is installed#Get location[string]$currentPath=Split-Path ((Get-Variable MyInvocation -Scope 0).Value).MyCommand.PathYeah I cast the variable, I typically only do that when I change a variable a lot so that I don’t do something stupid and assign a number in a variable I expect to be a: string, credential, hex, etc. So as you can see you can take the Split-Path command and use the Get-Variable and retrieve MyInvvocation -Scope 0 and getting the member mycommand and getting the path member on that. Yeah it’s a little convoluted, but it works, and it’s a one liner :-).Here’s the rest of the script, this was something I was using when I first setup my Steammachine on Windows, back when there wasn’t enough games on SteamOS to switch over, I don’t use it anymore– as it now runs SteamOS– and really haven’t changed it since I first wrote it… so use at your own risk :-).#This is the main script that starts for the Windows SteamBox#Version 0.1.3#Check to make sure Steam is installed#Get location[string]$currentPath=Split-Path ((Get-Variable MyInvocation -Scope 0).Value).MyCommand.Path#******BEING FUNCTIONS******##Run Windows Updates functionFunction Get-WindowsUpdate {    [Cmdletbinding()]    Param()    Process {        try {            Write-Verbose “Getting Windows Update”            $Session = New-Object -ComObject Microsoft.Update.Session                        $Searcher = $Session.CreateUpdateSearcher()                        $Criteria = “IsInstalled=0 and DeploymentAction=’Installation’ or IsPresent=1 and DeploymentAction=’Uninstallation’ or IsInstalled=1 and DeploymentAction=’Installation’ and RebootRequired=1 or IsInstalled=0 and DeploymentAction=’Uninstallation’ and RebootRequired=1”                       $SearchResult = $Searcher.Search($Criteria)                       $SearchResult.Updates | Out-File $currentPath\CurrentWindowsUpdates.txt        } catch {            Write-Warning -Message “Failed to query Windows Update because $($_.Exception.Message)” | Out-File $currentPath\ERROR.txt        }    }}#Start script$i = 0do{    [boolean]$SteamFileExists = test-path ${env:ProgramFiles(x86)}\Steam\Steam.exe    if ($SteamFileExists -eq $True){            $i = 1        }        Else        {            $SteamErrorPopup = new-object -comobject wscript.shell            $SteamErrorAnswer = $SteamErrorPopup.popup(“ERROR! STEAM NOT FOUND! “,0,”STEAM NOT FOUND!”,5)            #Check answer            switch ($SteamErrorAnswer)            {                1 {}                2 {Exit}                }            }} Until ($i -eq 1)#Steam Exitsts! Lets start steamStart-Process powershell -Argument “$currentpath\Managesteam.ps1”#Now that we have steam running, lets get to work on the background stuff#Initiate Variables#Wirte to file that steam ran and script worked$Date =  Get-Date$WriteToFile = “Ran correctly at: “ + $Date$WriteToFile | Out-File $currentPath\ran.txt#Run Windows UpdatesGet-WindowsUpdate"> <meta property="og:url" content="https://martinojones.com/powershell-get-current-directory-your/"> <meta property="og:site_name" content="Martino Jones"> <meta property="og:image" content="https://martinojones.com/assets/img/logo.jpg"> <link rel="canonical" href="https://martinojones.com/powershell-get-current-directory-your/"> <link href="https://martinojones.com/feed.xml" type="application/atom+xml" rel="alternate" title="Martino Jones Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="https://martinojones.com/assets/css/main.css"> <!-- JS --> <script src="https://martinojones.com/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="https://martinojones.com/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="https://martinojones.com/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="https://martinojones.com/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="https://martinojones.com/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="https://martinojones.com/favicon.png"> <link rel="shortcut icon" href="https://martinojones.com/favicon.ico"> <!-- Background Image --> <style type="text/css">body {background-image:url(https://martinojones.com/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="https://martinojones.com/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="https://martinojones.com/assets/img/logo.jpg" alt="Martino Jones photo" class="author-photo"> <h4>Martino Jones</h4> <p>This is my personal blog where I talk about projects I'm working on and other technology related things.</p> </li> <li><a href="https://martinojones.com/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="http://twitter.com/martinoj2009" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a> </li> <li> <a href="http://plus.google.com/+martinoj2009" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-google-plus-square"></i> Google+</a> </li> <li> <a href="http://linkedin.com/in/martinojones" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> </li> <li> <a href="http://github.com/martinoj2009" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> <li> <a href="http://steamcommunity.com/id/martinoj2009" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-steam-square"></i> Steam</a> </li> <li> <a href="https://youtube.com/user/martinoj2009" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-youtube-square"></i> Youtube</a> </li> </ul>
<!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="https://martinojones.com/posts/">All Posts</a></li> <li><a href="https://martinojones.com/tags/">All Tags</a></li> </ul> </li> <li><a href="https://martinojones.com/projects/">Projects</a></li> </ul>
<!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>PowerShell - get the current directory your script is in</h1> <h4>25 Mar 2015</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~3 minutes </p>
<!-- /.entry-reading-time --> <a class="btn zoombtn" href="https://martinojones.com/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <!-- martinojones.com --> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3961058330418465" data-ad-slot="8621008831" data-ad-format="auto"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script> Have you ever needed to make a PowerShell script and needed to get the current location of your running script? Of course you have! It doesn't happen often, but I've written scripts and needed to change certain files I expect to be in the current directory, of course I test to make sure the files are there before doing so... but none of that works unless you know where your script is, and I HATE hard coding locations into a script, I try to always use environment variables, because as a "scripter"/programmer you cannot assume things... duh!<br> <br> Anyway, I will use this old Steammachine script I wrote a while back as an example, let's start with the first line... well first couple:<br> <br> #This is the main script that starts for the Windows SteamBox<br> #Version 0.1.3<br> #Check to make sure Steam is installed<br> #Get location<br> [string]$currentPath=Split-Path ((Get-Variable MyInvocation -Scope 0).Value).MyCommand.Path<br> <br> <br> Yeah I cast the variable, I typically only do that when I change a variable a lot so that I don't do something stupid and assign a number in a variable I expect to be a: string, credential, hex, etc. So as you can see you can take the Split-Path command and use the Get-Variable and retrieve MyInvvocation -Scope 0 and getting the member mycommand and getting the path member on that. Yeah it's a little convoluted, but it works, and it's a one liner :-).<br> <br> Here's the rest of the script, this was something I was using when I first setup my Steammachine on Windows, back when there wasn't enough games on SteamOS to switch over, I don't use it anymore-- as it now runs SteamOS-- and really haven't changed it since I first wrote it... so use at your own risk :-).<br> <br> <br> <br> <br> <br> #This is the main script that starts for the Windows SteamBox<br> #Version 0.1.3<br> #Check to make sure Steam is installed<br> #Get location<br> [string]$currentPath=Split-Path ((Get-Variable MyInvocation -Scope 0).Value).MyCommand.Path<br> <br> #*****************BEING FUNCTIONS*******************#<br> <br> #Run Windows Updates function<br> Function Get-WindowsUpdate {<br> <br>     [Cmdletbinding()]<br>     Param()<br> <br>     Process {<br>         try {<br>             Write-Verbose "Getting Windows Update"<br>             $Session = New-Object -ComObject Microsoft.Update.Session            <br>             $Searcher = $Session.CreateUpdateSearcher()            <br>             $Criteria = "IsInstalled=0 and DeploymentAction='Installation' or IsPresent=1 and DeploymentAction='Uninstallation' or IsInstalled=1 and DeploymentAction='Installation' and RebootRequired=1 or IsInstalled=0 and DeploymentAction='Uninstallation' and RebootRequired=1"           <br>             $SearchResult = $Searcher.Search($Criteria)           <br>             $SearchResult.Updates | Out-File $currentPath\CurrentWindowsUpdates.txt<br>         } catch {<br>             Write-Warning -Message "Failed to query Windows Update because $($_.Exception.Message)" | Out-File $currentPath\ERROR.txt<br>         }<br>     }<br> }<br> <br> <br> #Start script<br> <br> $i = 0<br> do{<br>     [boolean]$SteamFileExists = test-path ${env:ProgramFiles(x86)}\Steam\Steam.exe<br>     if ($SteamFileExists -eq $True){<br>             $i = 1<br>         }<br>         Else<br>         {<br>             $SteamErrorPopup = new-object -comobject wscript.shell<br>             $SteamErrorAnswer = $SteamErrorPopup.popup(“ERROR! STEAM NOT FOUND! “,0,”STEAM NOT FOUND!”,5)<br> <br>             #Check answer<br>             switch ($SteamErrorAnswer)<br>             {<br>                 1 {}<br>                 2 {Exit}<br>                 }<br> <br>             }<br> <br> } Until ($i -eq 1)<br> <br> #Steam Exitsts! Lets start steam<br> Start-Process powershell -Argument "$currentpath\Managesteam.ps1"<br> <br> <br> #Now that we have steam running, lets get to work on the background stuff<br> #Initiate Variables<br> <br> <br> #Wirte to file that steam ran and script worked<br> $Date =  Get-Date<br> $WriteToFile = "Ran correctly at: " + $Date<br> $WriteToFile | Out-File $currentPath\ran.txt<br> <br> #Run Windows Updates<br> Get-WindowsUpdate <div class="entry-meta"> <br> <hr> <span class="entry-tags"></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=https://martinojones.com/powershell-get-current-directory-your/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Like</span> </a> <a href="https://twitter.com/intent/tweet?text=https://martinojones.com/powershell-get-current-directory-your/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=https://martinojones.com/powershell-get-current-directory-your/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> </header> <!-- JS --> <script src="https://martinojones.com/assets/js/jquery-1.12.0.min.js"></script> <script src="https://martinojones.com/assets/js/jquery.dlmenu.min.js"></script> <script src="https://martinojones.com/assets/js/jquery.goup.min.js"></script> <script src="https://martinojones.com/assets/js/jquery.magnific-popup.min.js"></script> <script src="https://martinojones.com/assets/js/jquery.fitvid.min.js"></script> <script src="https://martinojones.com/assets/js/scripts.js"></script> <!-- Asynchronous Google Analytics snippet --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-79568415-1', 'auto'); ga('require', 'linkid', 'linkid.js'); ga('send', 'pageview'); </script> <script type="text/javascript"> var disqus_shortname = 'martinoj2009'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
